import sys, json
import numpy as np
from functions import readScenario
from model import NSSC

human_scenario_file = "./scenarios/HumansNeandScenario_samplingHumansTest.txt"

def get_NSSC_vectors(scenario, start = 0, end = 500, n = 500):

    # d_humans = readScenario(scenario)
    scenario = sys.argv[1]
    # scenario = '{"nbLoci": 100000, "samplingVector": [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "scenario": [{"time": 0, "demeSizes":[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000], "migMatrix": [[0, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0, 0, 0, 0, 0, 0], [0.061111111111111116, 0, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0, 0, 0, 0, 0, 0], [0.061111111111111116, 0.061111111111111116, 0, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0, 0,0, 0, 0, 0], [0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0, 0, 0, 0, 0, 0], [0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0, 0, 0, 0, 0, 0], [0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0, 0, 0, 0, 0, 0], [0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0, 0,0, 0, 0, 0], [0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0.061111111111111116, 0.061111111111111116, 0, 0, 0, 0, 0, 0, 0], [0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0.061111111111111116, 0, 0, 0, 0, 0, 0, 0], [0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]}]}'
    model_humans = NSSC(json.loads(scenario))
    # start = 0
    # end = 100
    # n = 500
    x_vector = [0.1*(np.exp(i * np.log(1+10*end)/n)-1) for i in range(n+1)]
    IICR_specie = [model_humans.evaluateIICR(i) for i in x_vector]

    return {'x_vector': x_vector, 'IICR_specie': IICR_specie}

   
# print(json.dumps(sys.argv[1]))

# lines = sys.stdin.readlines()
# f = sys.argv[1]



print(json.dumps(get_NSSC_vectors(human_scenario_file)))



# print(json.dumps(get_NSSC_vectors({'nbLoci': 100000, 'samplingVector': [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'scenario': [{'time': 0, 'demeSizes':[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000], 'migMatrix': [[0, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0, 0, 0, 0, 0, 0], [0.061111111111111116, 0, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0, 0, 0, 0, 0, 0], [0.061111111111111116, 0.061111111111111116, 0, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0, 0,0, 0, 0, 0], [0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0, 0, 0, 0, 0, 0], [0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0, 0, 0, 0, 0, 0], [0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0, 0, 0, 0, 0, 0], [0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0, 0,0, 0, 0, 0], [0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0.061111111111111116, 0.061111111111111116, 0, 0, 0, 0, 0, 0, 0], [0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0.061111111111111116, 0, 0, 0, 0, 0, 0, 0], [0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0.061111111111111116, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]}]})))

# print(json.dumps({'result':sys.argv}))


# print(readScenario(human_scenario_file))

# print(json.dumps(get_NSSC_vectors(human_scenario_file)))


# jsonTest = '{"nombre":"mandy"}'

# jsonResult = json.loads(jsonTest)

# print(jsonTest)


